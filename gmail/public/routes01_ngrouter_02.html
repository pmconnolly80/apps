<!doctype html>
<html lang="en" ng-app="gmailApp">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Gmail routes with ngRoute</title>
  <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" media="screen">
  <link href="style.css" rel="stylesheet" media="screen">
  <script src="bower_components/angular/angular.js"></script>
  <script src="bower_components/angular-route/angular-route.js"></script>
  <script>
    angular.module('gmailApp', ['ngRoute'])
      .config(function($routeProvider, $locationProvider) {
        $routeProvider
          .when('/inbox', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'messages-nav.tpl.html',
            contentUrl: 'messages-list.tpl.html',
            resolve: {
              messages: function($q, $timeout) {
                var delay = $q.defer();
                $timeout(delay.resolve, 1000);
                return delay.promise;
              }
            }
          })
          .when('/inbox/:msgid', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'messages-nav.tpl.html',
            contentUrl: 'messages-details.tpl.html'
          })
          .when('/sent', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'messages-nav.tpl.html',
            contentUrl: 'messages-sent.tpl.html'
          })
          .when('/drafts', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'messages-nav.tpl.html',
            contentUrl: 'messages-drafts.tpl.html'
          })
          .when('/label/:label', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'messages-nav.tpl.html',
            contentUrl: 'messages-label.tpl.html'
          })
          .when('/contacts', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'contacts-nav.tpl.html',
            contentUrl: 'contacts-list.tpl.html'
          })
          .when('/contacts/:contactid', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'contacts-nav.tpl.html',
            contentUrl: 'contacts-details.tpl.html'
          })
          .when('/contacts/group/:group', {
            templateUrl: 'two-cols.tpl.html',
            controller: 'NavigationCtrl',
            subnavUrl: 'contacts-nav.tpl.html',
            contentUrl: 'contacts-list.tpl.html'
          })
          .otherwise({redirectTo: '/inbox'});

        // $locationProvider.html5Mode(true);
      })
      .controller('NavigationCtrl', function($scope, $route, messages) {
        // Extract the template URLs for the subnav and the content area
        // from the route definition object, based on the current route.
        // When the path changes, the values for subnavUrl and contentUrl change too.
        $scope.templates = {
          subnavUrl: $route.current.$$route.subnavUrl,
          contentUrl: $route.current.$$route.contentUrl,
        };
        $scope.params = $route.current.params;
      });
  </script>
  <script type="text/ng-template" id="two-cols.tpl.html">
    <!-- This template lets us create two subregions in the ng-view. -->
    <div class="row">
      <div class="col-xs-3 well">
        <div ng-include="templates.subnavUrl"></div>
      </div>
      <div class="col-xs-5 well">
        <div ng-include="templates.contentUrl"</div>
      </div>
    </div>
  </script>
  <script type="text/ng-template" id="messages-nav.tpl.html">
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#/inbox">Inbox</a></li>
      <li><a href="#/sent">Sent</a></li>
      <li><a href="#/drafts">Drafts</a></li>
      <li class="divider"><hr></li>
      <li><a href="#/label/work">Label "work"</a></li>
      <li><a href="#/label/personal">Label "personal"</a></li>
    </ul>
  </script>
  <script type="text/ng-template" id="messages-list.tpl.html">
    <p>Inbox (list of messages)</p>
    <p><a href="#/inbox/45">View message details</a></p>
  </script>
  <script type="text/ng-template" id="messages-details.tpl.html">
    Details of message {{params.msgid}}
  </script>
  <script type="text/ng-template" id="messages-sent.tpl.html">
    Sent
  </script>
  <script type="text/ng-template" id="messages-drafts.tpl.html">
    Drafts
  </script>
  <script type="text/ng-template" id="messages-label.tpl.html">
    Messages with label "{{params.label}}".
  </script>
  <script type="text/ng-template" id="contacts-nav.tpl.html">
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#/contacts/group/984">Family</a></li>
      <li><a href="#/contacts/group/23">Friends</a></li>
      <li><a href="#/contacts/group/109">Work</a></li>
    </ul>
  </script>
  <script type="text/ng-template" id="contacts-list.tpl.html">
    <p>Contacts <span ng-show="params.group">in group {{params.group}}</span></p>
    <p><a href="#/contacts/32">View contact details</a></p>
  </script>
  <script type="text/ng-template" id="contacts-details.tpl.html">
    Details of contact {{params.contactid}}
  </script>
</head>
<body>

  <div class="container">

    <!-- Main Nav -->
    <div class="row">
      <div class="col-xs-12">
        <ul class="nav nav-pills">
          <li><a href="#inbox">Messages</a></li>
          <li><a href="#contacts">Contacts</a></li>
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12">
        <!-- Content included dynamically based on the current route -->
        <div ng-view></div>
      </div>
    </div>

  </div><!-- /.container -->
</body>
</html>
